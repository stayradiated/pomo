// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator kysely {
  provider = "prisma-kysely"

  // Optionally provide a destination directory for the generated file
  // and a filename of your choice
  output      = "../src"
  fileName    = "db.generated.ts"
  readOnlyIds = true
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        String @id
  createdAt Int
  updatedAt Int?
  timeZone  String @default("UTC")
}

model Stream {
  id        String  @id
  name      String  @unique
  createdAt Int
  updatedAt Int?
  pointList Point[]
}

model Point {
  id         String       @id
  stream     Stream       @relation(fields: [streamId], references: [id])
  streamId   String
  value      String
  startedAt  Int
  createdAt  Int
  updatedAt  Int?
  PointLabel PointLabel[]

  @@index([streamId, startedAt], name: "streamId_startedAt")
}

model Label {
  id         String       @id
  name       String       @unique
  createdAt  Int
  updatedAt  Int?
  PointLabel PointLabel[]
}

model PointLabel {
  point     Point  @relation(fields: [pointId], references: [id])
  pointId   String
  label     Label  @relation(fields: [labelId], references: [id])
  labelId   String
  createdAt Int
  updatedAt Int?

  @@id([pointId, labelId])
}
